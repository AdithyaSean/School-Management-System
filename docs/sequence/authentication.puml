@startuml Authentication Sequence

actor User
participant "Login UI" as UI
participant "Authentication Controller" as Auth
participant "User Service" as UserSvc
participant "Fingerprint Service" as FP
database "User Database" as DB
participant "User Log Service" as Log

User -> UI: Select Login Method
activate UI

alt Password Login
    User -> UI: Enter Credentials
    UI -> Auth: validateCredentials(username, password)
    activate Auth
else Biometric Login
    User -> UI: Initiate Biometric Scan
    UI -> Auth: validateBiometric(fingerprintData)
    activate Auth
    Auth -> FP: verifyFingerprint(fingerprintData)
    activate FP
    FP --> Auth: verification result
    deactivate FP
end

Auth -> UserSvc: validateUser()
activate UserSvc

UserSvc -> DB: findUser()
activate DB
DB --> UserSvc: return user
deactivate DB

alt Password Login
    UserSvc -> UserSvc: verifyPassword()
else Biometric Login
    UserSvc -> UserSvc: verifyUser()
end
UserSvc --> Auth: validation result
deactivate UserSvc

alt successful login
    Auth -> Log: updateUserLog(userId, "LOGIN")
    activate Log
    Log --> Auth: log updated
    deactivate Log
    
    Auth --> UI: success
    UI --> User: show dashboard
else failed login
    Auth --> UI: invalid credentials
    UI --> User: show error message
end

deactivate Auth
deactivate UI

@enduml
